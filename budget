import json
import os
from datetime import datetime

DATA_FILE = "data.json"

# Initialize data file
if not os.path.exists(DATA_FILE):
    with open(DATA_FILE, "w") as f:
        json.dump([], f)

# Load data
def load_data():
    with open(DATA_FILE, "r") as f:
        return json.load(f)

# Save data
def save_data(data):
    with open(DATA_FILE, "w") as f:
        json.dump(data, f, indent=4)

# Add a record
def add_record():
    date_str = input("Enter date (YYYY-MM-DD) [default today]: ")
    if not date_str:
        date_str = datetime.today().strftime("%Y-%m-%d")
    category = input("Enter category (e.g., food, salary): ")
    record_type = input("Type (income/expense): ").lower()
    if record_type not in ["income", "expense"]:
        print("Invalid type, please enter 'income' or 'expense'.")
        return
    try:
        amount = float(input("Enter amount: "))
    except ValueError:
        print("Amount must be a number.")
        return
    note = input("Note (optional): ")

    data = load_data()
    data.append({
        "date": date_str,
        "category": category,
        "type": record_type,
        "amount": amount,
        "note": note
    })
    save_data(data)
    print("Record added successfully!\n")

# View records
def view_records():
    data = load_data()
    if not data:
        print("No records found.\n")
        return
    print("No. | Date | Category | Type | Amount | Note")
    print("-"*50)
    for i, rec in enumerate(data, 1):
        print(f"{i} | {rec['date']} | {rec['category']} | {rec['type']} | {rec['amount']} | {rec['note']}")
    print()

# Statistics
def stats():
    data = load_data()
    if not data:
        print("No records found.\n")
        return
    income = sum(rec["amount"] for rec in data if rec["type"] == "income")
    expense = sum(rec["amount"] for rec in data if rec["type"] == "expense")
    balance = income - expense
    print(f"Total Income: {income}")
    print(f"Total Expense: {expense}")
    print(f"Balance: {balance}\n")

# Main menu
def main():
    while True:
        print("=== Command-Line Budget Tool ===")
        print("1. Add Record")
        print("2. View Records")
        print("3. Statistics")
        print("4. Exit")
        choice = input("Choose an option (1-4): ")
        if choice == "1":
            add_record()
        elif choice == "2":
            view_records()
        elif choice == "3":
            stats()
        elif choice == "4":
            print("Exiting program...")
            break
        else:
            print("Invalid choice, please try again.\n")

if __name__ == "__main__":
    main()

